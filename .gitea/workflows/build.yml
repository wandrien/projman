name: Gitea Actions Demo
run-name: ${{ gitea.actor }} is testing out Gitea Actions ğŸš€
on: [push]

jobs:
  Explore-Gitea-Actions:
    runs-on: tcl-tk-builder
    steps:
      - run: echo "ğŸ‰ The job was automatically triggered by a ${{ gitea.event_name }} event."
      - run: echo "ğŸ§ This job is now running on a ${{ runner.os }} server hosted by Gitea!"
      - run: echo "ğŸ” The name of your branch is ${{ gitea.ref }} and your repository is ${{ gitea.repository }}."
      - run: echo "${{ vars.main_url }}${{ gitea.repository }}"
      - name: Build the packages
        run: |
          git clone ${{ vars.main_url }}${{ gitea.repository }}
          pwd
          cd projman/debian
          ./build-deb-projman.sh
          cd ../../
          #echo "curl --user ${{ vars.user}}:${{vars.api_token}} --upload-file *.deb ${{vars.main_url}}/api/packages/${{vars.user}}/debian/pool/bookworm/main/upload"
          export PACKAGE_FILE=$(ls -1| grep projman | grep -E "deb$")
          curl --user ${{ vars.user}}:${{vars.api_token}} --upload-file "${{ PACKAGE_FILE }}" ${{vars.main_url}}api/packages/${{vars.user}}/debian/pool/bookworm/main/upload
      - run: echo "ğŸ This job's status is ${{ job.status }}."
